{"ast":null,"code":"// Utility functions for user management\nimport usersData from '../data/users.json';\nexport const saveUserToLocalStorage = user => {\n  const expiresAt = Date.now() + 24 * 60 * 60 * 1000; // 24 tiếng\n  localStorage.setItem('currentUser', JSON.stringify({\n    ...user,\n    expiresAt\n  }));\n};\nexport const getCurrentUser = () => {\n  const userStr = localStorage.getItem('currentUser');\n  if (!userStr) return null;\n  try {\n    const user = JSON.parse(userStr);\n    if (user.expiresAt && Date.now() > user.expiresAt) {\n      // Hết hạn, tự động logout\n      localStorage.removeItem('currentUser');\n      return null;\n    }\n    return user;\n  } catch {\n    return null;\n  }\n};\nexport const logoutUser = () => {\n  localStorage.removeItem('currentUser');\n};\nexport const registerNewUser = userData => {\n  // Generate new user ID\n  const newUserId = `u${Date.now()}`;\n  const newUser = {\n    id: newUserId,\n    username: userData.username,\n    email: userData.email,\n    password: userData.password,\n    name: userData.fullName,\n    avatar: '/avatar1.png',\n    wallet: '',\n    learnPassId: '',\n    balance: 0,\n    createdAt: new Date().toISOString().split('T')[0]\n  };\n\n  // Add to users array\n  usersData.users.push(newUser);\n\n  // Save to localStorage for demo\n  const existingUsers = JSON.parse(localStorage.getItem('users') || '[]');\n  existingUsers.push(newUser);\n  localStorage.setItem('users', JSON.stringify(existingUsers));\n  return newUser;\n};\nexport const validateUser = (username, password) => {\n  // Check in localStorage first (for newly registered users)\n  const localUsers = JSON.parse(localStorage.getItem('users') || '[]');\n  const localUser = localUsers.find(u => u.username === username && u.password === password);\n  if (localUser) {\n    return localUser;\n  }\n\n  // Check in original data\n  const user = usersData.users.find(u => u.username === username && u.password === password);\n  return user || null;\n};\nexport const isUsernameTaken = username => {\n  const localUsers = JSON.parse(localStorage.getItem('users') || '[]');\n  const localExists = localUsers.some(u => u.username === username);\n  if (localExists) return true;\n  return usersData.users.some(u => u.username === username);\n};\nexport const isEmailTaken = email => {\n  const localUsers = JSON.parse(localStorage.getItem('users') || '[]');\n  const localExists = localUsers.some(u => u.email === email);\n  if (localExists) return true;\n  return usersData.users.some(u => u.email === email);\n};","map":{"version":3,"names":["usersData","saveUserToLocalStorage","user","expiresAt","Date","now","localStorage","setItem","JSON","stringify","getCurrentUser","userStr","getItem","parse","removeItem","logoutUser","registerNewUser","userData","newUserId","newUser","id","username","email","password","name","fullName","avatar","wallet","learnPassId","balance","createdAt","toISOString","split","users","push","existingUsers","validateUser","localUsers","localUser","find","u","isUsernameTaken","localExists","some","isEmailTaken"],"sources":["C:/Users/lepha/Downloads/eduWallet/src/utils/userUtils.js"],"sourcesContent":["// Utility functions for user management\r\nimport usersData from '../data/users.json';\r\n\r\nexport const saveUserToLocalStorage = (user) => {\r\n  const expiresAt = Date.now() + 24 * 60 * 60 * 1000; // 24 tiếng\r\n  localStorage.setItem('currentUser', JSON.stringify({ ...user, expiresAt }));\r\n};\r\n\r\nexport const getCurrentUser = () => {\r\n  const userStr = localStorage.getItem('currentUser');\r\n  if (!userStr) return null;\r\n  try {\r\n    const user = JSON.parse(userStr);\r\n    if (user.expiresAt && Date.now() > user.expiresAt) {\r\n      // Hết hạn, tự động logout\r\n      localStorage.removeItem('currentUser');\r\n      return null;\r\n    }\r\n    return user;\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const logoutUser = () => {\r\n  localStorage.removeItem('currentUser');\r\n};\r\n\r\nexport const registerNewUser = (userData) => {\r\n  // Generate new user ID\r\n  const newUserId = `u${Date.now()}`;\r\n  \r\n  const newUser = {\r\n    id: newUserId,\r\n    username: userData.username,\r\n    email: userData.email,\r\n    password: userData.password,\r\n    name: userData.fullName,\r\n    avatar: '/avatar1.png',\r\n    wallet: '',\r\n    learnPassId: '',\r\n    balance: 0,\r\n    createdAt: new Date().toISOString().split('T')[0]\r\n  };\r\n\r\n  // Add to users array\r\n  usersData.users.push(newUser);\r\n  \r\n  // Save to localStorage for demo\r\n  const existingUsers = JSON.parse(localStorage.getItem('users') || '[]');\r\n  existingUsers.push(newUser);\r\n  localStorage.setItem('users', JSON.stringify(existingUsers));\r\n  \r\n  return newUser;\r\n};\r\n\r\nexport const validateUser = (username, password) => {\r\n  // Check in localStorage first (for newly registered users)\r\n  const localUsers = JSON.parse(localStorage.getItem('users') || '[]');\r\n  const localUser = localUsers.find(u => u.username === username && u.password === password);\r\n  \r\n  if (localUser) {\r\n    return localUser;\r\n  }\r\n  \r\n  // Check in original data\r\n  const user = usersData.users.find(u => u.username === username && u.password === password);\r\n  return user || null;\r\n};\r\n\r\nexport const isUsernameTaken = (username) => {\r\n  const localUsers = JSON.parse(localStorage.getItem('users') || '[]');\r\n  const localExists = localUsers.some(u => u.username === username);\r\n  \r\n  if (localExists) return true;\r\n  \r\n  return usersData.users.some(u => u.username === username);\r\n};\r\n\r\nexport const isEmailTaken = (email) => {\r\n  const localUsers = JSON.parse(localStorage.getItem('users') || '[]');\r\n  const localExists = localUsers.some(u => u.email === email);\r\n  \r\n  if (localExists) return true;\r\n  \r\n  return usersData.users.some(u => u.email === email);\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}