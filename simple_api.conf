# EduWallet Backend API
# Domain: api-eduwallet.mojistudio.vn
# Proxy to Node.js on Port 3005

<VirtualHost *:80>
    ServerName api-eduwallet.mojistudio.vn
    Redirect permanent / https://api-eduwallet.mojistudio.vn/
</VirtualHost>

<VirtualHost *:443>
    ServerName api-eduwallet.mojistudio.vn

    SSLEngine on
    SSLCertificateFile /www/server/panel/vhost/cert/api-eduwallet.mojistudio.vn/fullchain.pem
    SSLCertificateKeyFile /www/server/panel/vhost/cert/api-eduwallet.mojistudio.vn/privkey.pem

    ProxyPreserveHost On
    ProxyPass / http://localhost:3005/
    ProxyPassReverse / http://localhost:3005/

    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://localhost:3005/$1 [P,L]

    <Location /health>
        ProxyPass http://localhost:3005/health
        ProxyPassReverse http://localhost:3005/health
    </Location>

    ErrorLog /www/wwwlogs/api-eduwallet_error.log
    CustomLog /www/wwwlogs/api-eduwallet_access.log combined
</VirtualHost>